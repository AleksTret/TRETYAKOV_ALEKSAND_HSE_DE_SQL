# Защита финального домашнего задания

**Выполнил - Третьяков Александр Юрьевич**

### Задание

Для защиты финальной работы нужно написать запрос, который выводит число клиентов, имеющих
только одну карту, имеющих две карты и т. д.
Если мое задание не совсем корректное, то подкорректируйте его самостоятельно.
Приведите не только запрос, но и результат его выполнения. Если результат получается пустым,
добавьте в БД несколько записей, чтобы результат получался непустым, иначе трудно оценить
правильность запроса.

### Решение

```sql
WITH client_card_counts AS (
    SELECT 
        client_id,
        COUNT(card_id) as card_count
    FROM tbg.crp_cards
    WHERE status_card = 'ACT'  -- только активные карты
    GROUP BY client_id
)
SELECT 
    card_count AS "Количество карт",
    COUNT(client_id) AS "Число клиентов"
FROM client_card_counts
GROUP BY card_count
ORDER BY card_count;
```

Результат выполнения

<img src="./assets/2026-01-09 212313.jpg" width="700">