# Домашнее задание 10

**Выполнил - Третьяков Александр Юрьевич**

## Упражение 14

### Задание
Выполните обход дерева организационной структуры снизу
вверх, начиная с конкретного узла, можно с помощью функции
`up_tree_traversal()` либо функции `up_tree_traversal2()`. Сначала сделайте это с помощью первой из функций:
```sql
SELECT * FROM up_tree_traversal( 6 );
```
Параметром этих функций является код работника. Измените
код работника и повторите команду.
Теперь воспользуйтесь второй функцией. Учтите, что она возвращает `SETOF RECORD`, поэтому команда будет более сложной:
```sql
SELECT * FROM up_tree_traversal2( 6 ) AS (emp int, boss int);
```
Очевидно, что для использования числового кода работника
нужно знать этот код. Удобнее иметь дело с именем работника.
Поэтому можно в качестве параметра этих функций использовать
подзапрос, возвращающий код работника в качестве своего результата. Не забудьте, что текст подзапроса заключается в скобки, поэтому появляются двойные скобки:
```sql
SELECT * FROM up_tree_traversal( ( SELECT … FROM Personnel
WHERE …) );
```
Завершите эту команду и выполните ее с различными именами
работников.


### Решение

Сначала посмотрим всех сотрудников
```sql
SELECT emp_nbr, emp_name FROM Personnel ORDER BY emp_nbr;
```
<img src="./assets/ex_14/2025-11-24 201710.jpg" width="700">

Обход с помощью первой функции `up_tree_traversal()`
С кодом работника 6 (Анна):
```sql
SELECT * FROM up_tree_traversal(6);
```
С кодом работника 8 (Николай):
```sql
SELECT * FROM up_tree_traversal(8);
```
С кодом работника 3 (Антон):
```sql
SELECT * FROM up_tree_traversal(3);
```
<img src="./assets/ex_14/2025-11-24 201734.jpg" width="500">

Обход с помощью второй функции `up_tree_traversal2()`
С кодом работника 6:
```sql
SELECT * FROM up_tree_traversal2(6) AS (emp int, boss int);
```
С кодом работника 8:
```sql
SELECT * FROM up_tree_traversal2(8) AS (emp int, boss int);
```

<img src="./assets/ex_14/2025-11-24 201949.jpg" width="500">

Обход по имени работника 
Для работника "Анна":
```sql
SELECT * FROM up_tree_traversal((SELECT emp_nbr FROM Personnel WHERE emp_name = 'Анна'));
```
Для работника "Николай":
```sql
SELECT * FROM up_tree_traversal((SELECT emp_nbr FROM Personnel WHERE emp_name = 'Николай'));
```
Для работника "Иван" (президент):
```sql
SELECT * FROM up_tree_traversal((SELECT emp_nbr FROM Personnel WHERE emp_name = 'Иван'));
```

<img src="./assets/ex_14/2025-11-24 202221.jpg" width="700">

Вторая функция с именами работников
Для работника "Анна":
```sql
SELECT * FROM up_tree_traversal2((SELECT emp_nbr FROM Personnel WHERE emp_name = 'Анна')) AS (emp int, boss int);
```
Для работника "Захар":
```sql
SELECT * FROM up_tree_traversal2((SELECT emp_nbr FROM Personnel WHERE emp_name = 'Захар')) AS (emp int, boss int);
```

<img src="./assets/ex_14/2025-11-24 202408.jpg" width="700">