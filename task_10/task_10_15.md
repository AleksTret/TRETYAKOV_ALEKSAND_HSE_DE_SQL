# Домашнее задание 10

**Выполнил - Третьяков Александр Юрьевич**

## Упражение 15

### Задание
Выполните операцию удаления поддерева с помощью функции `delete_subtree()`. Параметром функции является код работника.
```sql
SELECT * FROM delete_subtree( 6 );
```
Аналогично работе с функцией `up_tree_traversal()` используйте
подзапрос для получения кода работника по его имени. После удаления поддерева посмотрите, что стало с организационной структурой,
с помощью двух представлений `Personnel_org_chart` и `Create_paths`.
### Решение

Посмотрим текущую организационную структуру
```sql
SELECT * FROM Personnel_org_chart ORDER BY emp_nbr;
```
<img src="./assets/ex_15/2025-11-24 202833.jpg" width="700">

Посмотрим пути в структуре
```sql
SELECT * FROM Create_paths;
```
<img src="./assets/ex_15/2025-11-24 202912.jpg" width="700">

Выполним удаление поддерева с кодом работника 6 (Анна)
```sql
SELECT delete_subtree(6);
```
Проверим изменения в организационной структуре
```sql
SELECT * FROM Personnel_org_chart ORDER BY emp_nbr;
```
Проверим изменения в путях
```sql
SELECT * FROM Create_paths;
```

<img src="./assets/ex_15/2025-11-24 203020.jpg" width="700">

Удалим поддерево по имени работника "Андрей" (код 7)
```sql
SELECT delete_subtree((SELECT emp_nbr FROM Personnel WHERE emp_name = 'Андрей'));
```
Снова проверим структуру
```sql
SELECT * FROM Personnel_org_chart ORDER BY emp_nbr;
```
Проверим пути после второго удаления
```sql
SELECT * FROM Create_paths;
```

<img src="./assets/ex_15/2025-11-24 203347.jpg" width="700">